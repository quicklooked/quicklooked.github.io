!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).flowplayer=t.flowplayer||{},t.flowplayer.float_on_scroll=e())}(this,(function(){"use strict";const t=[].slice;function e(t,e,n){const o=function(t){return Array.isArray(t)?t.slice(0):t.split(".")}(e);for(;o.length;){if(null==t)return n;const e=o.shift();if("string"!=typeof e)return n;t=t[e]}return null==t?n:t}var n="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;const o=!!function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return t}()&&{passive:!0},i=["touchstart","touchmove"];function r(t){var e=t;return e.emit=function(t,n,o={}){const i=function(t){const e=document.createEvent("Event");return e.initEvent(t,!1,!0),e}(t);return n&&function(t,e,...n){for(const n in e)t[n]=e[n]}(i,{data:n||{}}),e.dispatchEvent(i),!1===o.return_self?i:e},e.on=function(t,n){return"string"==typeof t&&(t=t.split(" ")),t.forEach((function(t){return function(t){return~i.indexOf(t)}(t)?e.addEventListener(t,n,o):e.addEventListener(t,n)})),e},e.off=function(t,n){return e.removeEventListener(t,n),e},e.one=e.once=function(t,n){return e.on(t,(function o(i){e.off(t,o),n(i)}))},e}const a=Array.isArray,u="undefined"!=typeof window&&r(window),s="undefined"!=typeof document&&r(document),l=["span","a","em","p","i"];function f(t,e,n){var o=p(document.createElement(t));if(a(e)&&(n=e,e=!1),n||(n=[]),n&&!a(n)&&(n=[n]),n.length&&n.filter(t=>!!t).forEach(t=>o.append(t)),"object"!=typeof e)return o;for(var i in e)i in o?o[i]=e[i]:o.setAttribute(i,e[i]);return o}function c(e){var n=e.tagName;e.__flowplayer__=1,e.find=function(t){var n=e.querySelector(t);return n?p(n):n},e.html=function(t){return e.innerHTML=t,e},e.empty=function(){return e.innerHTML="",e},e.offset=function(){var t={top:0,left:0},n=e;do{t.left+=n.offsetLeft||0,t.top+=n.offsetTop||0}while(n=n.offsetParent);return t},e.innerWidth=function(){var t=getComputedStyle(e);return e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)};var o=e.insert=function(t,n){return n?a(n)?n.map((function(n){return e.insert(t,n)}))[0]:p(n="string"==typeof n?e.insertAdjacentHTML(t,n):e.insertAdjacentElement?e.insertAdjacentElement(t,n):e.appendChild(n)):n};return e.append=o.bind(e,"beforeend"),e.prepend=o.bind(e,"afterbegin"),e.css=function(t,n){if("object"==typeof t){for(const n in t)e.css(n,t[n]);return e}return void 0===n&&"string"==typeof t?getComputedStyle(e)[t]:("number"==typeof n&&(n+="px"),e.style[t]=n,e)},e.show=function(){return e.css({display:~l.indexOf(n)?"inline":"block"})},e.hide=function(){return e.css({display:"none"})},e.remove=function(){var t=e.parentNode;t&&t.removeChild(e)},e.attr=function(t,n){return null==n?e.getAttribute(t):(e.setAttribute(t,n),e)},e.txt=function(t){return e.textContent=t,e},e.fp=function(t){return e.addClass("fp-"+t)},e.addClass=function(t){return t.split(" ").forEach((function(t){e.hasClass(t)||(e.className+=(e.className?" ":"")+t)})),e},e.removeClass=function(t){const n=t.split(" ");var o=e.className.split(" ");return e.className=o.filter((function(t){return!~n.indexOf(t)})).join(" "),e},e.toggleClass=function(t,n){return void 0===n&&(n=!e.hasClass(t)),n?e.addClass(t):e.removeClass(t)},e.findAll=function(n){return o=e.querySelectorAll(n),t.call(o);var o},e.hasClass=function(t){return~e.className.split(" ").indexOf(t)},e}function p(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:c(r(t))}function d(t,e){if("string"==typeof t&&"<"==t[0])return f(t.slice(1,-1),e);if("string"!=typeof t)return p(t);var n=e instanceof HTMLElement&&e.querySelector(".fp-"+t)||document.querySelector(t);return n?p(n):void 0}const m=t=>(e,n)=>("string"==typeof e&&(e={class:e}),f(t,e,n));Object.assign(d,{div:m("div"),img:m("img"),li:m("li"),ol:m("ol"),span:m("span"),p:m("p"),i:m("i"),a:m("a"),el:f,document:s,window:u});var v="float:pop:in",h="float:pop:out",g=Object.freeze({__proto__:null,POP_IN:v,POP_OUT:h});var w=Object.freeze({__proto__:null,NO_STANDARD_CONTROLS:1<<20}),_={coords:"-22 -22 122 122",link:"#fp-mute",translation_key:"core.mute",name:"fp-mute"},y={coords:"-22 -22 122 122",link:"#fp-unmute",translation_key:"core.mute",name:"fp-unmute"},A={coords:"19 0 80 80",link:"#fp-close",translation_key:"core.close",name:"fp-close"};function C(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function b(t){var e,n,o=C("svg");return o.setAttribute("viewBox",t.coords),t.name&&o.setAttribute("class",t.name),t.title&&o.setAttribute("title",t.title),t.title&&o.setAttribute("aria-label",t.title),o.setAttribute("tabindex","0"),o.setAttribute("focusable","true"),o.appendChild((e=t.link,(n=C("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),n)),d(o)}var E={PLACEHOLDER:void 0,FLOATING_CONTAINER:void 0},N="flowplayer-floating-container",O="flowplayer-floating-placeholder",x="fp-on",L="no-standard-controls";function T(t,e){return function(t){const e=t.getBoundingClientRect(),n=window.innerHeight,o=e.y;return o>n||o+e.height<0?0:e.y<0?(e.height+o)/e.height:n-e.y>e.height?1:Math.abs((n-e.y)/e.height)}(e.is_wrapped?t:j())>.8}function P(){return E.FLOATING_CONTAINER=E.FLOATING_CONTAINER||d.div().attr("id",N)}function j(){return E.PLACEHOLDER=E.PLACEHOLDER||d.div().attr("id",O)}function k(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)}function R(t){var e=t.ui.reaper.put("float_wrapper",d.div("fp-float-wrapper"));return t.appendChild(e),Array.from(t.childNodes).forEach((function(t){"fp-ratio"!==t.className&&t!==e&&e.appendChild(t)})),e}function S(t,n,o){if(0!=o.reaper&&!o.floating){if(t.is_wrapped){var i=o.root.clientWidth,r=o.root.clientHeight;return o.emit(h),void setTimeout((function(){var t=n.ui.float_wrapper;t.css({height:t.innerWidth()/i*r}),o.emit("resize")}))}var a=P(),u=j(),s=d.p().txt(o._t("float_on_scroll.popped_out","video playing in floating mode"));u.empty().appendChild(s);var l=n.aspect_ratio.cloneNode(!1);l&&u.append(l),k(u,n),a.append(n),a.addClass(x),a.toggleClass(L,function(t){return 1<<20&e(t,"opts.ui",0)}(o)),t.pop_out_container.appendChild(a),o.emit("resize"),o.emit(h)}}function D(t,e,n){if(0!=n.reaper&&n.floating){if(t.is_wrapped)return n.emit(v),void setTimeout((function(){e.ui.float_wrapper.css({height:"auto"}),n.emit("resize")}));var o=P(),i=j();k(e,i),o.removeClass(x),o.parentElement.removeChild(o),n.emit("resize"),n.emit(v)}}function H(t,o,i){if(!(t.multiplay||"float_on_scroll"in t&&0==t.float_on_scroll)){(function(){try{return window.self!==window.top}catch(t){return!0}})()&&console.warn("iframe detected - floating player not supported in iframe");var r=e(t,"float_on_scroll.wrap_inside",!!this.ads),a={pop_out_container:e(t,"float_on_scroll.container",r?R(o):document.body),was_user_toggled:!1,is_wrapped:r};a.is_wrapped&&i.on("renderplugin",(function(t){t.preventDefault(),a.pop_out_container.appendChild(t.data)}));var u=e(o,"ui.header");u&&function(t,e,n,o){var i=d.div("fp-exit-float");i.append(b(A).attr("role","button")),i.on("click",(function(){e.was_user_toggled=!0,o.togglePlay(!1),D(e,n,o)})),t.append(i);var r=d.div("fp-mute-float"),a=b(_).attr("role","button"),u=b(y).attr("role","button");r.append([a,u]),r.on("click",(function(){o.toggleMute()})),t.append(r)}(u,a,o,i);var s,l,f,c,p,m,g,w=(s=function(){T(o,a)&&D(a,o,i)},c=l||60,p=Math.ceil(1e3/c),m=Date.now(),g=null,function(){var t=Date.now()-m;null===g&&(g=(f||n)((function(){g=null,s.apply(this,arguments),m=Date.now()}),Math.max(0,p-t)))});i.on("viewleave",(function(){(function(t){return!t.paused||!(!t.ads||!t.ads.adPlaying)})(i)&&!a.was_user_toggled&&S(a,o,i)})),i.on("viewenter",(function(){a.was_user_toggled=!1})),i.on(h,(function(){window.on("scroll",w),i.floating=!0,i.setState("is-popped-out",!0),a.is_wrapped&&window.on("resize",C)})),i.on(v,(function(){window.off("scroll",w),i.floating=!1,i.setState("is-popped-out",!1),a.is_wrapped&&window.off("resize",C)}))}function C(){var t,e,n,i,r;e=(t=o).getBoundingClientRect(),n=t.ui.float_wrapper.getBoundingClientRect(),i=e.height/e.width,(r=n.height/n.width)!==i&&setTimeout((function(){t.ui.float_wrapper.css({height:n.height*i/r})}))}}return H.events=g,H.flags=w,function(t,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in t||(t.flowplayer={extensions:[]});var n=t.flowplayer;return"function"==typeof n?(n(e),e):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(e)||n.extensions.push(e),e)}(window,H)}));
