!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((e="undefined"!=typeof globalThis?globalThis:e||self).flowplayer=e.flowplayer||{},e.flowplayer.gemius=n())}(this,(function(){"use strict";function e(e,n,r){const a=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(n);for(;a.length;){if(null==e)return r;const n=a.shift();if("string"!=typeof n)return r;e=e[n]}return null==e?r:e}var n=["playerID","gemiusID"],r=["programID","additionalParameters.programName","additionalParameters.programType","additionalParameters.programDuration"],a=["adName","adDuration","adType","campaignClassification","quality","resolution","volume"];function o(n,r){var a=[];return r.forEach((function(r){void 0===e(n,r)&&a.push(r)})),a.length&&console.warn("Missing Gemius configuration: ",a.join(", ")),0===a.length}function t(e){return e<.5||isNaN(e)?0:Math.round(e)}return function(e,n){if("object"==typeof exports&&"undefined"!=typeof module)return n;"flowplayer"in e||(e.flowplayer={extensions:[]});var r=e.flowplayer;return"function"==typeof r?(r(n),n):(Array.isArray(r.extensions)||(r.extensions=[]),~r.extensions.indexOf(n)||r.extensions.push(n),n)}(window,(function(i,u,d){if("function"!=typeof GemiusPlayer)return console.warn("Gemius SDK needs to be loaded prior loading gemius plugin");var m=!1,l=!1,s=!1,c=!1,p=0,f=null,g=!1,v=flowplayer.util.extend,y={},D=null;function E(){s=!1,m=!1,l=!1,c=!1,f=null,p=0,g=!1}function P(){D&&D.programEvent(y.programID,t(d.currentTime),"play",{autoPlay:y.additionalParameters.autoPlay,volume:y.additionalParameters.volume||0})}function T(){if(!D&&o(e(i,"gemius",{}),n)){var a={currentDomain:y.additionalParameters.currentDomain,volume:y.additionalParameters.volume||0};if((D=new GemiusPlayer(y.playerID,y.gemiusID,a)).setVideoObject(d),o(y,r)){var t={programName:y.additionalParameters.programName,programDuration:y.additionalParameters.programDuration,programType:y.additionalParameters.programType,volume:y.additionalParameters.volume};D.newProgram(y.programID,t)}}}function h(){D&&D.programEvent(y.programID,t(d.currentTime),"close"),E()}if(d.on("reap",(function(){D&&D.programEvent(y.programID,t(d.currentTime),"stop"),D=void 0,E(),window.removeEventListener("beforeunload",h)})),window.addEventListener("beforeunload",h),d.on("config",(function(n){Object.assign(y,e(n.data,"gemius",{}))})),d.on("src",(function(n){Object.assign(y,e(n.data,"gemius",{})),T()})),d.on("loadedmetadata",(function(n){Object.assign(y,e(n.data,"gemius",{})),T()})),d.on("volumechange",(function(){let e=d.muted?-1:Math.round(100*d.volume);D&&D.programEvent(y.programID,t(d.currentTime),"chngVol",{volume:e})})),d.on("resize",(function(e){D&&D.programEvent(y.programID,t(d.currentTime),"chngRes",{resolution:e.srcElement.clientWidth+"x"+e.srcElement.clientHeight})})),d.on("play",(function(){c=!1,m=!0,l=!1,P()})),d.on("ended",(function(){m&&(m=!1,l=!1,D&&D.programEvent(y.programID,t(d.currentTime),"complete"))})),d.on("seeking",(function(){m&&!s&&(s=!0,D&&D.programEvent(y.programID,p,"seek"))})),d.on("seeked",(function(){m&&!l&&(s=!1,D&&D.programEvent(y.programID,t(d.currentTime),"play",{autoPlay:y.additionalParameters.autoPlay,volume:y.additionalParameters.volume||0}))})),d.on("pause",(function(){m&&d.currentTime>.25&&(i.live||i.duration&&i.duration-d.currentTime>.25)&&(l=!0,D&&D.programEvent(y.programID,t(d.currentTime),"pause"))})),d.on("waiting",(function(){c||(c=!0,D&&D.programEvent(y.programID,t(d.currentTime),"buffer"))})),d.on("timeupdate",(function(){p=Math.round(d.currentTime)})),d.ads){var w=flowplayer.AdEvents;d.ads.on(w.AD_STARTED,(function(e){var n;m||(m=!0,P()),g||(g=!0,D&&D.programEvent(y.programID,t(d.currentTime),"break")),l=!1,f={id:e.vast_ad_id||"unknown id",duration:e.ad.duration||-1,currentTime:0},D.newAd(e.vast_ad_id,(n=v(v({},y.additionalParameters),function(e){return{adDuration:e.ad.duration,adType:e.ad_type,resolution:e.ad.width+"x"+e.ad.height,volume:e.volume}}(e)),a.reduce((function(e,r){return n&&n.hasOwnProperty(r)&&(e[r]=n[r]),e}),{}))),D.adEvent(y.programID,f.id,0,"play",{autoPlay:y.additionalParameters.autoPlay,volume:e.volume})})),d.ads.on(w.AD_PAUSED,(function(){l=!0,f&&D.adEvent(y.programID,f.id,f.currentTime,"pause")})),d.ads.on(w.AD_RESUMED,(function(e){f&&l&&(l=!1,D.adEvent(y.programID,f.id,f.currentTime,"play",{autoPlay:y.additionalParameters.autoPlay,volume:e.volume}))})),d.ads.on(w.AD_COMPLETED,(function(){f&&(D.adEvent(y.programID,f.id,f.duration,"complete"),f=null)})),d.ads.on(w.AD_BREAK_COMPLETED,(function(){g=!1})),d.ads.on(w.AD_PROGRESS,(function(e){f&&(f.currentTime=Math.round(e.duration-e.remaining)||0)})),d.ads.on(w.AD_VOLUME_CHANGED,(function(e){if(f){let n=e||-1;D.adEvent(y.programID,f.id,f.duration,"chngVol",{volume:n})}}))}}))}));
